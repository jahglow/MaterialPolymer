<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="..\..\bower_components/polymer/polymer.html">
<link rel="import" href="..\..\bower_components/paper-drawer-panel/paper-drawer-panel.html">
<link rel="import" href="..\..\bower_components/paper-scroll-header-panel/paper-scroll-header-panel.html">

<dom-module id="report-master">
  <template>
<style>
  :host .content-container>::content #reportalPage{height:100%}
</style>
    <paper-drawer-panel id="paperDrawerPanel">
      <!-- Drawer Scroll Header Panel -->
      <paper-scroll-header-panel drawer fixed>
        <!-- Drawer Content-->
        <content select="#reportalSidebar"></content>
      </paper-scroll-header-panel>

      <!-- Main Area -->
      <div main class="content-container">
        <content select="#reportalPage"></content>
      </div>
    </paper-drawer-panel>

    <!-- Uncomment next block to enable Service Worker support (1/2) -->
    <!--
    <paper-toast id="caching-complete"
                 duration="6000"
                 text="Caching complete! This app will work offline.">
    </paper-toast>

    <platinum-sw-register auto-register
                          clients-claim
                          skip-waiting
                          on-service-worker-installed="displayInstalledToast">
      <platinum-sw-cache default-cache-strategy="networkFirst"
                         precache-file="precache.json">
      </platinum-sw-cache>
    </platinum-sw-register>
    -->

  </template>
  <script>
  (function() {
    Polymer({
      is: 'report-master',
      listeners:{
        'paper-header-transform':'_condenseHeader',
        'tap':'_panelToggle'
      },
      _panelToggle:function(e){
        if(e.target.hasAttribute('paper-drawer-toggle') || e.target.parentNode.hasAttribute('paper-drawer-toggle')){
          this.$.paperDrawerPanel.openDrawer();
        }
      },
      _condenseHeader:function(e){
        this.async(function() {
          var appName = Polymer.dom(e.target).querySelector('.app-name');
          var middleContainer = Polymer.dom(e.target).querySelector('.middle-container');
          var bottomContainer = Polymer.dom(e.target).querySelector('.bottom-container');
          var detail = e.detail;
          var heightDiff = detail.height - detail.condensedHeight;
          var yRatio = Math.min(1, detail.y / heightDiff);
          var maxMiddleScale = 0.50;  // appName max size when condensed. The smaller the number the smaller the condensed size.
          var scaleMiddle = Math.max(maxMiddleScale, (heightDiff - detail.y) / (heightDiff / (1 - maxMiddleScale)) + maxMiddleScale);
          var scaleBottom = 1 - yRatio;

          // Move/translate middleContainer
          this.transform('translate3d(0,' + yRatio * 100 + '%,0)', middleContainer);

          // Scale bottomContainer and bottom sub title to nothing and back
          this.transform('scale(' + scaleBottom + ') translateZ(0)', bottomContainer);

          // Scale middleContainer appName
          this.transform('scale(' + scaleMiddle + ') translateZ(0)', appName);
        });
      }
    });
  })();
  </script>
</dom-module>



